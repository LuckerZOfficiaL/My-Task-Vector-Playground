{
    "results": {
        "Cars": [
            {
                "acc/test": 0.7390871644020081,
                "loss/test": 0.751002311706543
            }
        ],
        "DTD": [
            {
                "acc/test": 0.561170220375061,
                "loss/test": 1.5364360809326172
            }
        ],
        "EuroSAT": [
            {
                "acc/test": 0.9059259295463562,
                "loss/test": 0.3677968382835388
            }
        ],
        "GTSRB": [
            {
                "acc/test": 0.43357086181640625,
                "loss/test": 2.0223159790039062
            }
        ],
        "MNIST": [
            {
                "acc/test": 0.6341000199317932,
                "loss/test": 1.4177366495132446
            }
        ],
        "RESISC45": [
            {
                "acc/test": 0.6355555653572083,
                "loss/test": 1.156627893447876
            }
        ],
        "SVHN": [
            {
                "acc/test": 0.4832513928413391,
                "loss/test": 1.7225210666656494
            }
        ],
        "SUN397": [
            {
                "acc/test": 0.6489672660827637,
                "loss/test": 1.2368757724761963
            }
        ],
        "STL10": [
            {
                "acc/test": 0.9768750071525574,
                "loss/test": 0.09037109464406967
            }
        ],
        "OxfordIIITPet": [
            {
                "acc/test": 0.8601799011230469,
                "loss/test": 0.3729495704174042
            }
        ],
        "Flowers102": [
            {
                "acc/test": 0.6817368865013123,
                "loss/test": 1.4528672695159912
            }
        ],
        "CIFAR100": [
            {
                "acc/test": 0.6664999723434448,
                "loss/test": 1.260705828666687
            }
        ],
        "PCAM": [
            {
                "acc/test": 0.75543212890625,
                "loss/test": 0.5051021575927734
            }
        ],
        "FER2013": [
            {
                "acc/test": 0.50069659948349,
                "loss/test": 1.5360238552093506
            }
        ],
        "average_of_tasks": 0.6773606368473598
    },
    "results_all_iters": {
        "0": {
            "Cars": [
                {
                    "acc/test": 0.6259171962738037,
                    "loss/test": 1.089281439781189
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.457446813583374,
                    "loss/test": 2.0317864418029785
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.5387963056564331,
                    "loss/test": 1.3657138347625732
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.4321456849575043,
                    "loss/test": 2.148716688156128
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.5252000093460083,
                    "loss/test": 1.8299634456634521
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.6644444465637207,
                    "loss/test": 1.0965020656585693
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.5237399935722351,
                    "loss/test": 1.791903018951416
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6531485915184021,
                    "loss/test": 1.2246012687683105
                }
            ],
            "STL10": [
                {
                    "acc/test": 0.9821249842643738,
                    "loss/test": 0.07889693975448608
                }
            ],
            "OxfordIIITPet": [
                {
                    "acc/test": 0.8762605786323547,
                    "loss/test": 0.35562705993652344
                }
            ],
            "Flowers102": [
                {
                    "acc/test": 0.7062937021255493,
                    "loss/test": 1.2524031400680542
                }
            ],
            "CIFAR100": [
                {
                    "acc/test": 0.6578999757766724,
                    "loss/test": 1.3468555212020874
                }
            ],
            "PCAM": [
                {
                    "acc/test": 0.5350341796875,
                    "loss/test": 0.7507601380348206
                }
            ],
            "FER2013": [
                {
                    "acc/test": 0.3590136468410492,
                    "loss/test": 1.9129812717437744
                }
            ],
            "average_of_tasks": 0.6098190077713558
        },
        "1": {
            "Cars": [
                {
                    "acc/test": 0.629399299621582,
                    "loss/test": 1.0715616941452026
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.4556737542152405,
                    "loss/test": 2.0323667526245117
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.6404629349708557,
                    "loss/test": 1.1109007596969604
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.48749011754989624,
                    "loss/test": 1.8547147512435913
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.7364000082015991,
                    "loss/test": 1.4015321731567383
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.6684126853942871,
                    "loss/test": 1.0683045387268066
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.6155884861946106,
                    "loss/test": 1.4815822839736938
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6536020040512085,
                    "loss/test": 1.217248558998108
                }
            ],
            "STL10": [
                {
                    "acc/test": 0.9818750023841858,
                    "loss/test": 0.07890671491622925
                }
            ],
            "OxfordIIITPet": [
                {
                    "acc/test": 0.8743526935577393,
                    "loss/test": 0.3541826903820038
                }
            ],
            "Flowers102": [
                {
                    "acc/test": 0.7048300504684448,
                    "loss/test": 1.2766942977905273
                }
            ],
            "CIFAR100": [
                {
                    "acc/test": 0.6884999871253967,
                    "loss/test": 1.168840765953064
                }
            ],
            "PCAM": [
                {
                    "acc/test": 0.55859375,
                    "loss/test": 0.76509028673172
                }
            ],
            "FER2013": [
                {
                    "acc/test": 0.3969072103500366,
                    "loss/test": 1.8794389963150024
                }
            ],
            "average_of_tasks": 0.6494348560060773
        },
        "2": {
            "Cars": [
                {
                    "acc/test": 0.633876383304596,
                    "loss/test": 1.0462368726730347
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.4955673813819885,
                    "loss/test": 1.8257626295089722
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.5725463032722473,
                    "loss/test": 1.2520408630371094
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.5770388245582581,
                    "loss/test": 1.4714272022247314
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.7896999716758728,
                    "loss/test": 1.193101406097412
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.6580952405929565,
                    "loss/test": 1.0943950414657593
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7024431228637695,
                    "loss/test": 1.1596322059631348
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6514861583709717,
                    "loss/test": 1.2168266773223877
                }
            ],
            "STL10": [
                {
                    "acc/test": 0.9815000295639038,
                    "loss/test": 0.08112933486700058
                }
            ],
            "OxfordIIITPet": [
                {
                    "acc/test": 0.8669937252998352,
                    "loss/test": 0.35278213024139404
                }
            ],
            "Flowers102": [
                {
                    "acc/test": 0.7012522220611572,
                    "loss/test": 1.3160046339035034
                }
            ],
            "CIFAR100": [
                {
                    "acc/test": 0.6938999891281128,
                    "loss/test": 1.1275043487548828
                }
            ],
            "PCAM": [
                {
                    "acc/test": 0.65057373046875,
                    "loss/test": 0.6840028762817383
                }
            ],
            "FER2013": [
                {
                    "acc/test": 0.4477570354938507,
                    "loss/test": 1.7760562896728516
                }
            ],
            "average_of_tasks": 0.673052151288305
        },
        "3": {
            "Cars": [
                {
                    "acc/test": 0.6318866014480591,
                    "loss/test": 1.0444669723510742
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5257092118263245,
                    "loss/test": 1.6592437028884888
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8128703832626343,
                    "loss/test": 0.6407867074012756
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.6425970196723938,
                    "loss/test": 1.2220031023025513
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.7113000154495239,
                    "loss/test": 1.23079252243042
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.6506349444389343,
                    "loss/test": 1.1082665920257568
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.6138598918914795,
                    "loss/test": 1.3884824514389038
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6513853669166565,
                    "loss/test": 1.2219295501708984
                }
            ],
            "STL10": [
                {
                    "acc/test": 0.9781249761581421,
                    "loss/test": 0.08635428547859192
                }
            ],
            "OxfordIIITPet": [
                {
                    "acc/test": 0.8669937252998352,
                    "loss/test": 0.36003121733665466
                }
            ],
            "Flowers102": [
                {
                    "acc/test": 0.6900308728218079,
                    "loss/test": 1.3862932920455933
                }
            ],
            "CIFAR100": [
                {
                    "acc/test": 0.6851000189781189,
                    "loss/test": 1.174432635307312
                }
            ],
            "PCAM": [
                {
                    "acc/test": 0.714508056640625,
                    "loss/test": 0.5661576986312866
                }
            ],
            "FER2013": [
                {
                    "acc/test": 0.480913907289505,
                    "loss/test": 1.671661615371704
                }
            ],
            "average_of_tasks": 0.6897082137210029
        },
        "4": {
            "Cars": [
                {
                    "acc/test": 0.6316378712654114,
                    "loss/test": 1.0533950328826904
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5585106611251831,
                    "loss/test": 1.615749716758728
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.5664814710617065,
                    "loss/test": 1.1870973110198975
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.7192398905754089,
                    "loss/test": 0.9483785033226013
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.8371999859809875,
                    "loss/test": 0.8724039793014526
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7865079641342163,
                    "loss/test": 0.6700398921966553
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7711662650108337,
                    "loss/test": 0.8263835906982422
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6481612324714661,
                    "loss/test": 1.2439937591552734
                }
            ],
            "STL10": [
                {
                    "acc/test": 0.9763749837875366,
                    "loss/test": 0.0862942487001419
                }
            ],
            "OxfordIIITPet": [
                {
                    "acc/test": 0.8656309843063354,
                    "loss/test": 0.35763031244277954
                }
            ],
            "Flowers102": [
                {
                    "acc/test": 0.6879167556762695,
                    "loss/test": 1.4627169370651245
                }
            ],
            "CIFAR100": [
                {
                    "acc/test": 0.677299976348877,
                    "loss/test": 1.2704565525054932
                }
            ],
            "PCAM": [
                {
                    "acc/test": 0.5784912109375,
                    "loss/test": 0.9106227159500122
                }
            ],
            "FER2013": [
                {
                    "acc/test": 0.4816104769706726,
                    "loss/test": 1.7313380241394043
                }
            ],
            "average_of_tasks": 0.699016409260886
        },
        "5": {
            "Cars": [
                {
                    "acc/test": 0.7390871644020081,
                    "loss/test": 0.751002311706543
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.561170220375061,
                    "loss/test": 1.5364360809326172
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.9059259295463562,
                    "loss/test": 0.3677968382835388
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.43357086181640625,
                    "loss/test": 2.0223159790039062
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.6341000199317932,
                    "loss/test": 1.4177366495132446
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.6355555653572083,
                    "loss/test": 1.156627893447876
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.4832513928413391,
                    "loss/test": 1.7225210666656494
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6489672660827637,
                    "loss/test": 1.2368757724761963
                }
            ],
            "STL10": [
                {
                    "acc/test": 0.9768750071525574,
                    "loss/test": 0.09037109464406967
                }
            ],
            "OxfordIIITPet": [
                {
                    "acc/test": 0.8601799011230469,
                    "loss/test": 0.3729495704174042
                }
            ],
            "Flowers102": [
                {
                    "acc/test": 0.6817368865013123,
                    "loss/test": 1.4528672695159912
                }
            ],
            "CIFAR100": [
                {
                    "acc/test": 0.6664999723434448,
                    "loss/test": 1.260705828666687
                }
            ],
            "PCAM": [
                {
                    "acc/test": 0.75543212890625,
                    "loss/test": 0.5051021575927734
                }
            ],
            "FER2013": [
                {
                    "acc/test": 0.50069659948349,
                    "loss/test": 1.5360238552093506
                }
            ],
            "average_of_tasks": 0.6773606368473598
        }
    },
    "cfg": {
        "nn": {
            "data": {
                "dataset": {
                    "dataset_name": "CIFAR100",
                    "ft_epochs": 6,
                    "posthoc_epochs": 2,
                    "finegrained_epochs": 1,
                    "num_classes": 100
                },
                "accelerator": "gpu",
                "batch_size": {
                    "test": 128,
                    "train": 128,
                    "val": 128
                },
                "data_path": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/data",
                "num_workers": {
                    "test": 0,
                    "train": 4,
                    "val": 2
                },
                "train_dataset": "CIFAR100Val"
            },
            "module": {
                "_target_": "tvp.pl_module.image_classifier.ImageClassifier",
                "x_key": "x",
                "y_key": "y",
                "encoder": "??",
                "classifier": "??",
                "optimizer": {
                    "_target_": "torch.optim.AdamW",
                    "lr": 1e-05,
                    "weight_decay": 0.1
                },
                "model": {
                    "_target_": "tvp.modules.encoder.ImageEncoder",
                    "model_name": "ViT-B-16",
                    "openclip_cachedir": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/openclip_cache",
                    "cache_dir": null,
                    "keep_lang": "??"
                },
                "lr_scheduler": {
                    "warmup_steps_or_ratio": 200
                }
            }
        },
        "train": {
            "seed_index": 0,
            "deterministic": false,
            "trainer": {
                "fast_dev_run": false,
                "accelerator": "gpu",
                "devices": 1,
                "precision": 32,
                "max_steps": -1,
                "num_sanity_val_steps": 2,
                "gradient_clip_val": 10.0,
                "val_check_interval": 1.0,
                "deterministic": false
            },
            "restore": {
                "ckpt_or_run_path": null,
                "mode": null
            },
            "monitor": {
                "metric": "loss/train",
                "mode": "min"
            },
            "callbacks": [
                {
                    "_target_": "pytorch_lightning.callbacks.progress.tqdm_progress.TQDMProgressBar",
                    "refresh_rate": 1
                }
            ],
            "logging": {
                "upload": {
                    "run_files": false,
                    "source": true
                },
                "logger": {
                    "_target_": "lightning.pytorch.loggers.WandbLogger",
                    "project": "task-vectors-playground",
                    "entity": "dansolombrinoandfriends",
                    "log_model": false,
                    "mode": "online",
                    "tags": [
                        "dev"
                    ]
                }
            }
        },
        "conventions": {
            "x_key": "x",
            "y_key": "y"
        },
        "core": {
            "entity": "dansolombrinoandfriends",
            "project_name": "task-vectors-playground",
            "storage_dir": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/storage",
            "tags": [
                "dev"
            ],
            "version": "0.0.1"
        },
        "epoch_divisor": "None",
        "eval_datasets": [
            "Cars",
            "DTD",
            "EuroSAT",
            "GTSRB",
            "MNIST",
            "RESISC45",
            "SVHN",
            "SUN397",
            "STL10",
            "OxfordIIITPet",
            "Flowers102",
            "CIFAR100",
            "PCAM",
            "FER2013"
        ],
        "eval_on_train": false,
        "misc": {
            "cache_dir": null,
            "ckpt_path": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/ViT-B-16",
            "openclip_cachedir": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/openclip_cache",
            "pretrained_checkpoint": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/ViT-B-16/zeroshot.pt"
        },
        "order": 1,
        "seed_index": 0,
        "task_vectors": {
            "aggregator": {
                "_target_": "tvp.task_vectors.aggregator.SumAggregator",
                "mean": true
            },
            "breadcrumbs_beta": 0.85,
            "breadcrumbs_gamma": 0.993,
            "dare_rate": 0.9,
            "merging_method": "normal",
            "num_task_vectors": 8,
            "orthogonalize": false,
            "scaling_coefficient": 1,
            "ties_lambda": 1,
            "ties_topk": 0.15,
            "to_apply": [
                "Cars",
                "DTD",
                "EuroSAT",
                "GTSRB",
                "MNIST",
                "RESISC45",
                "SVHN",
                "SUN397",
                "STL10",
                "OxfordIIITPet",
                "Flowers102",
                "CIFAR100",
                "PCAM",
                "FER2013"
            ]
        },
        "ft_regime": "ta",
        "tvs_to_apply_group_name": "paper-tsv-14",
        "optimizer_name": "adamw",
        "lr_scheduler_name": "cosine_annealing",
        "upload_merged_to_wandb": false,
        "evaluation_export_dir": "./evaluations/merged_wita_grid_search",
        "eval_orthogonalization_method": "none",
        "eval_skip_if_exists": true,
        "timestamp": "2025_01_18_at_14_26_26",
        "eval_use_wita": true,
        "wita": {
            "top_k_weakest": 5,
            "top_k_strongest": 0,
            "num_iters": 5
        }
    }
}