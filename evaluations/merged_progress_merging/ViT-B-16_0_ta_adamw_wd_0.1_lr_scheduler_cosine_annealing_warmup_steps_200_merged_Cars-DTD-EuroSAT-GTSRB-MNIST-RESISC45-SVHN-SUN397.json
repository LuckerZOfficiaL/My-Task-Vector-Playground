{
    "results_all_ratios": {
        "0.1": {
            "Cars": [
                {
                    "acc/test": 0.670687735080719,
                    "loss/test": 0.9324924349784851
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.508865237236023,
                    "loss/test": 1.7554230690002441
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.7948148250579834,
                    "loss/test": 0.6778452396392822
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.5703879594802856,
                    "loss/test": 1.4665018320083618
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.8934999704360962,
                    "loss/test": 0.7792392373085022
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7376190423965454,
                    "loss/test": 0.8090742230415344
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7040565609931946,
                    "loss/test": 1.0445009469985962
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6774307489395142,
                    "loss/test": 1.1057045459747314
                }
            ],
            "average_of_tasks": 0.6946702599525452
        },
        "0.2": {
            "Cars": [
                {
                    "acc/test": 0.6852381825447083,
                    "loss/test": 0.8940174579620361
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5115247964859009,
                    "loss/test": 1.766119360923767
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.7546759247779846,
                    "loss/test": 0.73337721824646
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.5907363295555115,
                    "loss/test": 1.3756544589996338
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.926800012588501,
                    "loss/test": 0.5570090413093567
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7514285445213318,
                    "loss/test": 0.760834813117981
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7271050810813904,
                    "loss/test": 0.9562973380088806
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.682065486907959,
                    "loss/test": 1.086393117904663
                }
            ],
            "average_of_tasks": 0.7036967948079109
        },
        "0.3": {
            "Cars": [
                {
                    "acc/test": 0.6904613971710205,
                    "loss/test": 0.8729146122932434
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5106382966041565,
                    "loss/test": 1.809512972831726
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8200926184654236,
                    "loss/test": 0.599734902381897
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.5954077839851379,
                    "loss/test": 1.357981562614441
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9363999962806702,
                    "loss/test": 0.49363988637924194
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7587301731109619,
                    "loss/test": 0.7564656734466553
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7276428937911987,
                    "loss/test": 0.9343169331550598
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6847355365753174,
                    "loss/test": 1.090004324913025
                }
            ],
            "average_of_tasks": 0.7155135869979858
        },
        "0.4": {
            "Cars": [
                {
                    "acc/test": 0.698544979095459,
                    "loss/test": 0.8685252666473389
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.508865237236023,
                    "loss/test": 1.800487995147705
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.7845370173454285,
                    "loss/test": 0.6829981207847595
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.5991290807723999,
                    "loss/test": 1.3478426933288574
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9402999877929688,
                    "loss/test": 0.4760127067565918
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7626984119415283,
                    "loss/test": 0.730994701385498
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7216886878013611,
                    "loss/test": 0.9580812454223633
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.684584379196167,
                    "loss/test": 1.0904240608215332
                }
            ],
            "average_of_tasks": 0.7125434726476669
        },
        "0.5": {
            "Cars": [
                {
                    "acc/test": 0.6945653557777405,
                    "loss/test": 0.880814254283905
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.51241135597229,
                    "loss/test": 1.8100175857543945
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8077315092086792,
                    "loss/test": 0.6407321691513062
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.5976247191429138,
                    "loss/test": 1.3542025089263916
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9415000081062317,
                    "loss/test": 0.46108222007751465
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.758571445941925,
                    "loss/test": 0.7498588562011719
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7302550673484802,
                    "loss/test": 0.9152520895004272
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6844836473464966,
                    "loss/test": 1.0982050895690918
                }
            ],
            "average_of_tasks": 0.7158928886055946
        },
        "0.6": {
            "Cars": [
                {
                    "acc/test": 0.6954358816146851,
                    "loss/test": 0.8746744394302368
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.508865237236023,
                    "loss/test": 1.8164499998092651
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8109722137451172,
                    "loss/test": 0.6247221827507019
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.6000791788101196,
                    "loss/test": 1.333004117012024
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9420999884605408,
                    "loss/test": 0.45043250918388367
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7584127187728882,
                    "loss/test": 0.7477009892463684
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.737169623374939,
                    "loss/test": 0.8985397815704346
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6870025396347046,
                    "loss/test": 1.1009373664855957
                }
            ],
            "average_of_tasks": 0.7175046727061272
        },
        "0.7": {
            "Cars": [
                {
                    "acc/test": 0.6965551376342773,
                    "loss/test": 0.8720077872276306
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5097517967224121,
                    "loss/test": 1.8248707056045532
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8174074292182922,
                    "loss/test": 0.6180540323257446
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.6030086874961853,
                    "loss/test": 1.3312184810638428
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9440000057220459,
                    "loss/test": 0.4428863823413849
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7601587176322937,
                    "loss/test": 0.7450432181358337
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7298709154129028,
                    "loss/test": 0.9163463711738586
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.686448335647583,
                    "loss/test": 1.1008880138397217
                }
            ],
            "average_of_tasks": 0.718400128185749
        },
        "0.8": {
            "Cars": [
                {
                    "acc/test": 0.6965551376342773,
                    "loss/test": 0.8723523020744324
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5097517967224121,
                    "loss/test": 1.8233108520507812
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8175463080406189,
                    "loss/test": 0.6191735863685608
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.6026920080184937,
                    "loss/test": 1.3299604654312134
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9429000020027161,
                    "loss/test": 0.4453311562538147
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.760952353477478,
                    "loss/test": 0.7437724471092224
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7335970997810364,
                    "loss/test": 0.9052383303642273
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6869521141052246,
                    "loss/test": 1.102290391921997
                }
            ],
            "average_of_tasks": 0.7188683524727821
        },
        "0.9": {
            "Cars": [
                {
                    "acc/test": 0.695809006690979,
                    "loss/test": 0.8729472756385803
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.508865237236023,
                    "loss/test": 1.8249752521514893
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8197222352027893,
                    "loss/test": 0.6118491291999817
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.6030879020690918,
                    "loss/test": 1.327545404434204
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9438999891281128,
                    "loss/test": 0.44375601410865784
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7612698674201965,
                    "loss/test": 0.7429950833320618
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.734326958656311,
                    "loss/test": 0.9038112163543701
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6862972378730774,
                    "loss/test": 1.1027402877807617
                }
            ],
            "average_of_tasks": 0.7191598042845726
        },
        "1.0": {
            "Cars": [
                {
                    "acc/test": 0.695809006690979,
                    "loss/test": 0.8729463815689087
                }
            ],
            "DTD": [
                {
                    "acc/test": 0.5097517967224121,
                    "loss/test": 1.825259804725647
                }
            ],
            "EuroSAT": [
                {
                    "acc/test": 0.8196759223937988,
                    "loss/test": 0.6115639209747314
                }
            ],
            "GTSRB": [
                {
                    "acc/test": 0.6029295325279236,
                    "loss/test": 1.3277546167373657
                }
            ],
            "MNIST": [
                {
                    "acc/test": 0.9438999891281128,
                    "loss/test": 0.44508305191993713
                }
            ],
            "RESISC45": [
                {
                    "acc/test": 0.7615873217582703,
                    "loss/test": 0.7422693371772766
                }
            ],
            "SVHN": [
                {
                    "acc/test": 0.7339044213294983,
                    "loss/test": 0.9061505794525146
                }
            ],
            "SUN397": [
                {
                    "acc/test": 0.6863476037979126,
                    "loss/test": 1.102685570716858
                }
            ],
            "average_of_tasks": 0.7192381992936134
        }
    },
    "results": {
        "Cars": [
            {
                "acc/test": 0.695809006690979,
                "loss/test": 0.8729463815689087
            }
        ],
        "DTD": [
            {
                "acc/test": 0.5097517967224121,
                "loss/test": 1.825259804725647
            }
        ],
        "EuroSAT": [
            {
                "acc/test": 0.8196759223937988,
                "loss/test": 0.6115639209747314
            }
        ],
        "GTSRB": [
            {
                "acc/test": 0.6029295325279236,
                "loss/test": 1.3277546167373657
            }
        ],
        "MNIST": [
            {
                "acc/test": 0.9438999891281128,
                "loss/test": 0.44508305191993713
            }
        ],
        "RESISC45": [
            {
                "acc/test": 0.7615873217582703,
                "loss/test": 0.7422693371772766
            }
        ],
        "SVHN": [
            {
                "acc/test": 0.7339044213294983,
                "loss/test": 0.9061505794525146
            }
        ],
        "SUN397": [
            {
                "acc/test": 0.6863476037979126,
                "loss/test": 1.102685570716858
            }
        ],
        "average_of_tasks": 0.7192381992936134
    },
    "cfg": {
        "nn": {
            "data": {
                "dataset": {
                    "dataset_name": "CIFAR100",
                    "ft_epochs": 6,
                    "posthoc_epochs": 2,
                    "finegrained_epochs": 1,
                    "num_classes": 100
                },
                "accelerator": "gpu",
                "batch_size": {
                    "test": 128,
                    "train": 128,
                    "val": 128
                },
                "data_path": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/data",
                "num_workers": {
                    "test": 0,
                    "train": 4,
                    "val": 2
                },
                "train_dataset": "CIFAR100Val"
            },
            "module": {
                "_target_": "tvp.pl_module.image_classifier.ImageClassifier",
                "x_key": "x",
                "y_key": "y",
                "encoder": "??",
                "classifier": "??",
                "optimizer": {
                    "_target_": "torch.optim.AdamW",
                    "lr": 1e-05,
                    "weight_decay": 0.1
                },
                "model": {
                    "_target_": "tvp.modules.encoder.ImageEncoder",
                    "model_name": "ViT-B-16",
                    "openclip_cachedir": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/openclip_cache",
                    "cache_dir": null,
                    "keep_lang": "??"
                },
                "lr_scheduler": {
                    "warmup_steps_or_ratio": 200
                }
            }
        },
        "train": {
            "seed_index": 0,
            "deterministic": false,
            "trainer": {
                "fast_dev_run": false,
                "accelerator": "gpu",
                "devices": 1,
                "precision": 32,
                "max_steps": -1,
                "num_sanity_val_steps": 2,
                "gradient_clip_val": 10.0,
                "val_check_interval": 1.0,
                "deterministic": false
            },
            "restore": {
                "ckpt_or_run_path": null,
                "mode": null
            },
            "monitor": {
                "metric": "loss/train",
                "mode": "min"
            },
            "callbacks": [
                {
                    "_target_": "pytorch_lightning.callbacks.progress.tqdm_progress.TQDMProgressBar",
                    "refresh_rate": 1
                }
            ],
            "logging": {
                "upload": {
                    "run_files": false,
                    "source": true
                },
                "logger": {
                    "_target_": "lightning.pytorch.loggers.WandbLogger",
                    "project": "task-vectors-playground",
                    "entity": "dansolombrinoandfriends",
                    "log_model": false,
                    "mode": "online",
                    "tags": [
                        "dev"
                    ]
                }
            }
        },
        "conventions": {
            "x_key": "x",
            "y_key": "y"
        },
        "core": {
            "entity": "dansolombrinoandfriends",
            "project_name": "task-vectors-playground",
            "storage_dir": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/storage",
            "tags": [
                "dev"
            ],
            "version": "0.0.1"
        },
        "epoch_divisor": "None",
        "eval_datasets": [
            "Cars",
            "DTD",
            "EuroSAT",
            "GTSRB",
            "MNIST",
            "RESISC45",
            "SVHN",
            "SUN397"
        ],
        "eval_on_train": false,
        "misc": {
            "cache_dir": null,
            "ckpt_path": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/ViT-B-16",
            "openclip_cachedir": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/openclip_cache",
            "pretrained_checkpoint": "/mnt/KS_2TB/PARA/Projects/ATM/Alternating-Tuning-and-Merging/checkpoints/ViT-B-16/zeroshot.pt"
        },
        "order": 1,
        "seed_index": 0,
        "task_vectors": {
            "aggregator": {
                "_target_": "tvp.task_vectors.aggregator.SumAggregator",
                "mean": true
            },
            "breadcrumbs": {
                "beta": 0.85,
                "gamma": 0.993
            },
            "dare": {
                "rate": 0.9
            },
            "merging_method": "normal",
            "num_task_vectors": 8,
            "orthogonalize": false,
            "scaling_coefficient": 1,
            "ties": {
                "ties_lambda": 1,
                "top_k": 20,
                "merge_func": "mean"
            },
            "to_apply": [
                "Cars",
                "DTD",
                "EuroSAT",
                "GTSRB",
                "MNIST",
                "RESISC45",
                "SVHN",
                "SUN397"
            ]
        },
        "ft_regime": "ta",
        "tvs_to_apply_group_name": "paper-ta",
        "optimizer_name": "adamw",
        "lr_scheduler_name": "cosine_annealing",
        "upload_merged_to_wandb": false,
        "evaluation_export_dir": "./evaluations/merged_progress_merging",
        "eval_merged_ratios": [
            0.1,
            0.2,
            0.3,
            0.4,
            0.5,
            0.6,
            0.7,
            0.8,
            0.9,
            1.0
        ],
        "eval_skip_if_exists": true,
        "eval_orthogonalization_method": "none",
        "eval_ft_progress_merging": false,
        "timestamp": "2025_01_26_at_10_34_50"
    }
}